!function(e){function t(t){for(var a,r,l=t[0],d=t[1],s=t[2],p=0,u=[];p<l.length;p++)r=l[p],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&u.push(n[r][0]),n[r]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(e[a]=d[a]);for(c&&c(t);u.length;)u.shift()();return o.push.apply(o,s||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],a=!0,l=1;l<i.length;l++){var d=i[l];0!==n[d]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=i[0]))}return e}var a={},n={2:0},o=[];function r(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=a,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var l=window.webpackJsonp=window.webpackJsonp||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var c=d;o.push([1621,0]),i()}({1621:function(e,t,i){e.exports=i(1624)},1622:function(e,t){$(document).ready((function(){$(".side-menu-container").bind("mousewheel DOMMouseScroll",(function(e){var t=null;"mousewheel"==e.type?t=-1*e.originalEvent.wheelDelta:"DOMMouseScroll"==e.type&&(t=40*e.originalEvent.detail),t&&(e.preventDefault(),$(this).scrollTop(t+$(this).scrollTop()))})),("ru"===locale||"de"===locale||"pt"===locale||window.localStorage&&"false"===window.localStorage.new_badge)&&$("#new-badge").hide(),window.educationAccess||$("#editor_menu_brand_kit").click((function(){try{window.localStorage.new_badge="false",$("#new-badge").hide()}catch(e){console.log(e)}}))}))},1623:function(e,t){$(document).ready((function(){var e=new Viz.ImageSearch({container:"image_search_result",column:"image-search-column",columnHeightLeft:0,columnHeightRight:0,item:{dragOption:{appendTo:"#infographic_container"}},providerName:"pixabay-pexels"}),t=Viz.searchProvider.getInstance({name:"pixabay-pexels",freeLimit:parseInt(freeImageLibraryLimit)});function i(i){if(!i.length||i===e.options.lastSearch)return!1;e.options.lastSearch=i,e.options.page=1,e.setProvider(t),"en"!==locale&&"translateSearch"in window?translateSearch(i,(function(t){e.search(t),mixpanel.track("Photo Search",{keywords:i,translatedKeywords:t,locale:locale})})):(e.search(i),mixpanel.track("Photo Search",{keywords:i}))}$("#image_search").on("keyup",(function(e){13==e.keyCode&&i($.trim($(this).val()).toLowerCase())})),$("#image_search + button").on("click",(function(){i($.trim($("#image_search").val()).toLowerCase())})),$("#image_search_result").on("mousedown","span",(function(){var e,t=$(this).data("photoData");t.downloadId&&$.ajax({type:"GET",url:"/infographics/proxy_search_unsplash/trigger_download/"+t.downloadId}),"Pixabay"===t.provider?e='<p>Photo from <a href="https://pixabay.com/">Pixabay</a>':"Unsplash"===t.provider?e='<p>Photo by <a href="'+t.photographerLink+'">'+t.photographer+'</a> on <a href="https://unsplash.com/">Unsplash</a>':"Pexels"===t.provider&&(e='<p>Photo by <a href="'+t.photographerLink+'">'+t.photographer+'</a> on <a href="https://pexels.com/">Pexels</a>'),$(".image-search-footer p").replaceWith(e)})),$(".image-search-footer").on("click","a",(function(){window.open($(this).attr("href"),"_blank")}))}))},1624:function(e,t,i){"use strict";i.r(t),window.detectFF=function(){return navigator.userAgent.indexOf("Firefox")>-1},window.detectIE=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0&&parseInt(e.substring(a+5,e.indexOf(".",a)),10)},window.detectChromeLike=function(){return navigator.userAgent.indexOf("Chrome")>-1&&"Google Inc."===window.navigator.vendor};var a=$("#editor_nav"),n=$("#infographic_controls"),o=$("#infographic_container");function r(){var e=a.width()||0;o.css({paddingLeft:e,paddingRight:0,marginLeft:0}),n.css({marginLeft:"".concat(e,"px"),width:"calc(100% - ".concat(e,"px)")})}function l(e,t,i){$("#grid_container").html("");var a="#123";page&&page.background&&page.background.background&&!checkIfColorIsLight(page.background.background)&&(a="#fff");var n=2*pageGridSize+"px",o=$('<div id="grid_lines"></div>'),r=pageGridDisplay?.15:0;o.css({position:"absolute",top:0,left:0,height:"100%",width:"100%",opacity:r,"background-size":n+" "+n,"background-image":"repeating-linear-gradient(0deg, "+a+", "+a+", transparent 1px, transparent "+n+"), repeating-linear-gradient(-90deg, "+a+", "+a+", transparent 1px, transparent "+n+")","z-index":50,"pointer-events":"none"}),$("#grid_container").html(o)}function d(){var e=$("<div>"),t=parseFloat(width),i=parseFloat(height),a=pagesCount,n=!$("#embed_border_off").is(":checked"),o=$("#embed_fixed").is(":checked"),r=$("#embed_footer_on").length&&$("#embed_footer_on").is(":checked");(page&&page.pages_count&&(a=page.pages_count),a>1)&&(i=i*a+2*(a-1));var l=newDomain;"/"===l[l.length-1]&&(l=l.slice(0,-1));var d=$("<script>",{src:l+"/js/embed/v1/embed.js"}).attr("data-vg-id",embedData.community_id).attr("data-title",pageTitle).attr("data-w",t).attr("data-h",i);JSON.parse(document.getElementById("infographicMetadata").innerHTML)&&d.attr("data-multipage",!0),!0===n&&d.attr("data-b","true"),!0===o&&d.attr("data-fixed","true"),!1===r&&d.attr("data-f","false"),$("#textarea_embed").text(e.append(d).html())}function s(){var e=$("<div>"),t=parseFloat(width),i=parseFloat(height),a=pagesCount;(page&&page.pages_count&&(a=page.pages_count),a>1)&&(i=i*a+2*(a-1));var n=$("<script>",{src:"https://"+document.domain+"/js/embed/v1/embed.js"}).attr("data-vg-id",embedData.community_id).attr("data-title",pageTitle).attr("data-w",t).attr("data-h",i);JSON.parse(document.getElementById("infographicMetadata").innerHTML)&&n.attr("data-multipage",!0),n.attr("data-f","false"),$("#new_embed").val(e.append(n).html())}window.checkPageSize=function(e,t){for(var i in page_sizes)for(var a in page_sizes[i])if(page_sizes[i][a].width==e&&page_sizes[i][a].height==t)return $("#page_layout").val(a),$("#page_orientation_"+i).attr("checked",!0),[i,a];return i=parseFloat(t)>parseFloat(e)?"portrait":"landscape",$("#page_layout").val("custom"),$("#page_orientation_"+i).attr("checked",!0),[i,"custom"]},$(document).ready((function(){if($(document).keydown((function(e){var t=$(document.activeElement).is("input:focus, textarea:focus");if(8===e.keyCode&&!t)return!1})),width=pageW||816,height=pageH||1056,r(),$("#input_infographic_title").val(pageTitle),$("#infographic_title").html(pageTitle),checkPageSize(width,height),community&&!1===!!communityInvalid||window.is_public?(renderInitialEmbedOptions(publicLinkUrl),renderNewEmbedOptions(site_url+url_slug),generateEmbedCode(),generateNewEmbed(),activateEmbedOptions(),toggleSelectedOption($("#publish_in_share"),!1)):(renderNewEmbedOptions(businessAccess||businessOwner||premiumAccess?private_link_url:""),handleUnpublishOption(businessAccess||businessOwner||premiumAccess),toggleSelectedOption($(businessAccess||businessOwner||premiumAccess?"#private_in_share":"#unpublish_in_share"),!1)),l(width,height),setTimeout((function(){$(window).width()<935&&$("#hide_menu_btn").trigger("click.editor_menu")}),1),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1),$("#lock").on("click",(function(e){vgTooltipClose("lock_guide")})),$("#publish_in_share").on("click",(function(){is_public||($.each($(".share-option-btn"),(function(e,t){$(t).hasClass("selectedOption")&&toggleSelectedOption($(t),!0)})),toggleSelectedOption($(this),!1),publishMultipage(),mixpanel.track("Share Settings",{Button:"Public"}))})),$("#unpublish_in_share").on("click",(function(){is_public&&($.each($(".share-option-btn"),(function(e,t){$(t).hasClass("selectedOption")&&toggleSelectedOption($(t),!0)})),toggleSelectedOption($(this),!1),unpublishMultipage(!0),handleUnpublishOption(),mixpanel.track("Share Settings",{Button:"Hidden"}))})),$("#private_in_share").on("click",(function(e){if(freeAccess)return VGEditor.showShareUpgradeModal(),void mixpanel.track("Share Settings",{Button:"Private"});is_public&&(e.preventDefault(),$.each($(".share-option-btn"),(function(e,t){$(t).hasClass("selectedOption")&&toggleSelectedOption($(t),!0)})),toggleSelectedOption($(this),!1),unpublishMultipage(!0,!0),renderNewEmbedOptions(site_url("pl/"+private_link_id)),mixpanel.track("Share Settings",{Button:"Private"}))})),allow_control_comments&&!opened_comment_mode){var e=JSON.parse(document.getElementById("infographicMetadata").innerHTML);if(!e)return;var t={enable_comments:!0,infographic:e.id};$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"/rest/multipage/save_enable_comments",data:JSON.stringify(t)}).fail((function(e){console.log("fail to enable_disable comments: ",e)}))}$("#new_embed_options").on("click","#comments_switch",(function(){var e=$(this).is(":checked"),t=JSON.parse(document.getElementById("infographicMetadata").innerHTML);if(t){var i={enable_comments:e,infographic:t.id};$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"/rest/multipage/save_enable_comments",data:JSON.stringify(i)}).done((function(i){"ok"===i.status&&e&&mixpanel.track("Turn on comments",{Infographic:t.id})})).fail((function(e){console.log("fail to enable_disable comments: ",e)}))}})),$('#new_embed_options .team-share-switch input[type="checkbox"][name="team_share"]').siblings(".slider").on("click",(function(e){$(this).siblings("input");if(window.isTeamShareEnabled&&window.INFOGRAPHIC_USER_ID===window.CURRENT_USERID&&VGEditor.collaboration&&VGEditor.collaboration.isRTCEnabled()&&VGEditor.collaboration.displayKickConfirmation){if(!VGEditor.collaboration.displayKickConfirmation())return e.preventDefault(),!1;VGEditor.collaboration.disableShare()}})),$("#new_embed_options").on("change",'.team-share-switch input[type="checkbox"][name="team_share"]',(function(){var e,t=$(this),i=t.attr("checked")?"/share/team/":"/unshare/team/",a=$('label[for="team_share_toggle"]'),n=pageId,o=JSON.parse(document.getElementById("infographicMetadata").innerHTML);o&&(n=o.id),$.ajax({url:i+n,type:"POST",dataType:"json",data:o?"multipage=1":""}).done((function(i){if("ok"==i.status)if(window.isTeamShareEnabled=!!t.attr("checked"),t.attr("checked")){e='<img class="icon-sm" src="/media/v2_img/checkmark.svg" alt="Green Checkmark">'+__localizedStrings["editor.share.team_view"];try{VGEditor.initCollaboration(),VGEditor.collaboration&&VGEditor.collaboration.isRTCEnabled()&&VGEditor.collaboration.initLoadDesign(page.identifier,{},loadingError)}catch(e){console.log("Couldn't start RTC",e.message)}a.html(e).fadeIn(1e3,(function(){a.addClass("share-enabled")})),mixpanel.track("Share",{Via:"With Team",Infographic:page.identifier,templateId:o?o.template_id:"","Button Number":"Share with team",Location:"Share Panel",Page:"Editor"})}else e=__localizedStrings["editor.share.team_off"],a.html(e).removeClass("share-enabled")})).fail((function(e){$("#team_share_toggle").attr("checked","true"),alert("Unable to share with team")}))})),$("#publish_to_community").on("click",(function(){var e=JSON.parse(document.getElementById("infographicMetadata").innerHTML);if(1==$(this).data("published"))e?unpublishMultipage():$.ajax({type:"POST",url:"/community/remove",data:"id="+pageId,dataType:"json",success:function(e,t,i){"ok"==e.status?(setPublic(!1),mixpanel.track("Click On Unpublish"),create_simple_modal("modal-sm","unpublished_modal",__localizedStrings["editor.publish.infographic_unpublished"],__localizedStrings["editor.publish.community_remove"],null,null,null),$("#publish_to_community").data("published",!1).html(__localizedStrings["editor.publish"]),$("#embed_options").empty(),$("#btn_preview").attr("href","//"+document.domain+"/publish/"+pageId)):create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null)}});else{var t='<button class="btn btn-green btn-sm" type="button" id="publish_submit_btn">'+__localizedStrings["editor.publish"]+'</button><div id="invalidTitle">* '+__localizedStrings["editor.publish.title_warning"]+"</div>";create_simple_modal(null,"publish_modal",__localizedStrings["editor.publish.title"],"<div>"+__localizedStrings["editor.publish.info"]+"<div>"+__localizedStrings["editor.publish.title"]+":</div><br/><input id='publish_infographic_title' type='text' class='form-control' placeholder='"+__localizedStrings["editor.publish.infographic_title"]+"</div>'/><br/><div>* "+__localizedStrings["editor.publish.unpublish_info"]+"</div>",t,(function(t){$("div #invalidTitle").css({display:"none","margin-left":"20px"}),$("#publish_modal #publish_infographic_title").val(pageTitle),$("#publish_submit_btn").on("click",(function(){var t=$("#publish_modal #publish_infographic_title").val();/^.*[a-zA-Z0-9]+.*$/.exec(t)?(e?publishMultipage():publishToCommunity(),Intercom("trackEvent","Publish",{infographic_id:pageId,title:t}),Intercom("trackEvent","Completion")):$("div #invalidTitle").css("display","inline-block")}))}))}})),$("#snap_to_grid_input").on("change",(function(){pageGridSize=$(this).val(),pageGridSize<=5?(snapToGrid=!1,$(this).val(""),$(this).attr("placeholder","off")):(snapToGrid=!0,l(parseInt(page.dimension.width),parseInt(page.dimension.height))),page.setSnap(pageGridSize)})),$("#toggle_snapToGrid").on("click",(function(e){e.preventDefault(),snapToGrid=!snapToGrid,snapToGrid?$(this).css({opacity:1}):$(this).css({opacity:.1})})),$("#crop_canvas").on("click",(function(e){e.preventDefault(),pageCrop=!pageCrop,pageCrop?($(this).css({opacity:1}),$("#infographic").css({overflow:"hidden"}),$("#infographic_container").css({background:"#E0E0E0"})):($(this).css({opacity:.2}),$("#infographic").css({overflow:"visible"}),$("#infographic_container").css({background:"rgb(238, 238, 238)"}))})),$("#hide_menu_btn").on("click.editor_menu",(function(){$("#editor_nav").hasClass("open")?($("#editor_nav, #editor_nav .btn-group").removeClass("open"),VGEditor.toggleEditorMenu(null,!1)):$("#editor_nav").addClass("open"),r(),VGEditor.widgetCanvas.resizeCanvas()})),$(".editor-top-level-menu").on("click.editor_menu",(function(){$(this).parent().hasClass("open")?$(this).parent().removeClass("open"):($("#editor_nav").addClass("open"),$("#editor_nav .btn-group").removeClass("open"),$(this).parent().addClass("open")),VGEditor.toggleEditorMenu($(this).attr("id"),$(this).parent().hasClass("open")),r(),VGEditor.widgetCanvas.resizeCanvas()})),$(".editor-2nd-level-menu").on("click.editor_menu",(function(){$(this).parent().hasClass("open")?$(this).parent().removeClass("open"):($("#editor_nav .btn-group .btn-group").removeClass("open"),$(this).parent().addClass("open"))})),$("#input_infographic_title").on("blur keypress",(function(e){if("blur"==e.type||13==e.which)if($(this).hide(),$("#infographic_title").show(),"blur"==e.type){var t=$(this).val().replace(/[\/\\]/g,"");if(""==$.trim(t)&&(t="Untitled"),"undefined"!==typeof t&&t!==pageTitle){var i=JSON.parse(document.getElementById("infographicMetadata").innerHTML);if(i)return updateMultipageTitle(i.id,t,pageTitle),void(pageTitle=t);$(this).val(t),$("#infographic_title").text(t),page.report_title=t,page.save(),$.ajax({type:"POST",url:"/community/update_title",data:"id="+pageId+"&title="+t,dataType:"json",success:function(e,i,a){mixpanel.track("Change Infographic Title",{new_title:t,prev_title:pageTitle}),pageTitle=t,"ok"==e.status||"could not update title"==e.status||create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null),$("#infographic_title").removeAttr("style")}})}}else $(this).blur()})),$("#infographic_title, #edit_title_btn").on("click",(function(e){e.preventDefault(),$("#infographic_title").hide(),$("#input_infographic_title").show().focus().select()})),$(document).on("mouseup",(function(e){"input_infographic_title"!=e.target.id&&$("#input_infographic_title").is(":focus")&&("infographic_title"==e.target.id&&"input_infographic_title"==e.target.id||(e.preventDefault(),$("#infographic_title").show(),$("#input_infographic_title").blur()))})),$(".sharing-infographic").on("click",(function(e){e.preventDefault();var t=$(this).attr("href"),i=$(this).attr("title");is_public?window.open(t,i,"height=500,width=600"):$.ajax({type:"PUT",url:"/rest/infograph/set_public/"+pageId,data:JSON.stringify({is_public:1}),success:function(e,a,n){200!=e.code?create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null):(is_public=!0,$("input[name=public_private_toggle][value=1]").attr("checked",!0),window.open(t,i,"height=500,width=600"))}})})),$("#share_panel").on("click",(function(){if(!$("#share_container").is(":visible")){var e="/infograph/share_with_others/",t=JSON.parse(document.getElementById("infographicMetadata").innerHTML);e+=t?t.id+"?multipage=1":pageId,$.ajax({type:"GET",url:e,dataType:"html",success:function(e){$("#private_share_menu").html(e);try{VGEditor.track.mixpanel("Click on editor top menu button",{button:"share"})}catch(e){console.error(e)}},error:function(e,t,i){console.log(t)}})}})),$(".side-menu-container").on("mouseover",".widget-non-draggable",(function(){$(this).find(".premium-badge > span").text(window.__vg_translator.t("editor.widgets.premium_badge_hover")),$(this).find(".business-badge > span").text(window.__vg_translator.t("editor.widgets.premium_badge_hover"))})).on("mouseout",".widget-non-draggable",(function(){$(this).find(".premium-badge > span").text(window.__vg_translator.t("editor.widgets.premium_badge_default")),$(this).find(".business-badge > span").text(window.__vg_translator.t("editor.widgets.business_badge_default"))})),[].concat(us_states,ca_states).forEach((function(e){var t=e.name,i=e.abbreviation.toLowerCase(),a=e.image,n="undefined"!=typeof w_draggable?w_draggable:"";$("#editor .side-menu-container").find("ul[data-widget-category='map']").append('<li><div class="'+n+'" data-widget-type="viz.widget.standard.states.'+i+'"><img src="'+a+'"><div>'+t+"</div>"+("widget-non-draggable"==n?'<span class="premium-badge"><span>'+window.__vg_translator.t("editor.widgets.premium_badge_default")+"</span></span>":"")+"</div></li>")}));var i={lastUpdated:0,title:"",description:__localizedStrings["editor.check_out"],frame:"width=600,height=600,menubar=no,location=no,status=no",template:"javascript:void(window.open({url}, {title}, {frame}));",siteUrl:window.location.origin,pinterest:{title:__localizedStrings["editor.share.pinterest"],apiUrl:"//www.pinterest.com/pin/create/button/?",description:__localizedStrings["editor.images.high_def"],generateUrl:function(e,t){var a={url:i.siteUrl+"/"+url_slug,media:i.siteUrl+t,description:i.pinterest.description};return i.formatScriptUrl(this.apiUrl+$.param(a),this.title,i.frame)}},twitter:{title:__localizedStrings["editor.share.twitter"],apiUrl:"//twitter.com/intent/tweet?",generateUrl:function(e,t){var a={url:i.siteUrl+"/"+url_slug,text:__localizedStrings["editor.check_out"]};return i.formatScriptUrl(this.apiUrl+$.param(a),this.title,i.frame)}},facebook:{title:__localizedStrings["editor.editor.share.facebook"],apiUrl:"//www.facebook.com/sharer/sharer.php?",generateUrl:function(e,t){var a={u:i.siteUrl+"/"+url_slug};return i.formatScriptUrl(this.apiUrl+$.param(a),this.title,i.frame)}},google:{title:__localizedStrings["editor.share.google"],apiUrl:"//plus.google.com/share?",generateUrl:function(e,t,a){a={url:i.siteUrl+"/"+url_slug};return i.formatScriptUrl("{"+this.apiUrl+$.param(a)+"}",this.title,i.frame)}},linkedin:{title:__localizedStrings["editor.share.linkedin"],apiUrl:"//www.linkedin.com/shareArticle?",generateUrl:function(e,t,a){a={url:i.siteUrl+"/"+url_slug,mini:!0};return i.formatScriptUrl(this.apiUrl+$.param(a),this.title,i.frame)}},formatScriptUrl:function(e,t,a){var n=function(e){return"'"+e+"'"};return i.template.replace("{url}",n(e)).replace("{title}",n(t)).replace("{frame}",n(a))},share:function(e,t,a){if(!JSON.parse(document.getElementById("infographicMetadata").innerHTML))if(this.lastUpdated!=e.last_modified){var n=Math.max(e.dimension.width,e.dimension.height),o=Math.min(1,Math.max(.5,500/n));VGEditor.exportAs(e,{file:e.identifier,format:"png",scale:o,downloadable:!1},(function(n){n?$.ajax({url:"/infographics/share_image/"+e.identifier,type:"POST",data:"image_data="+encodeURIComponent(n.toDataURL("image/png")),processData:!1}).done((function(n){var o=[];t.forEach((function(t){i.hasOwnProperty(t)&&o.push({name:t,url:i[t].generateUrl(e,n.url)})})),i.lastUpdated=e.last_modified,a(o)})).fail((function(e){a()})):a()}))}else a()}};iconLoader=(new VIconLoader).load((function(){icon_widgets=this.getAllMetaData()||{}}));var a,n=new Viz.IconSearch({item:{dragOption:{appendTo:"#infographic_container"}}},iconLoader);function o(e,t,i){if(!e.length)return!1;a=e,n.resultContainer=i,n.search(e,t);var o=("shape"===n.resultContainer.data("widget-category")?"Icon":"Icon Chart")+" Search";"undefined"!==typeof mixpanel&&mixpanel.track(o,{pageNumber:0,query:e,filter:t,infographic:page.identifier})}function d(e,t,i){if(!e.length)return!1;"en"!==locale&&"translateSearch"in window?translateSearch(e,(function(e){o(e,t,i)})):o(e,t,i)}if($(document).on("keyup","#editor_nav .icon_search",(function(e){13==e.keyCode&&($(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"]:checked').prop("checked",!1),$(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"][value=""]').prop("checked",!0),d($.trim($(this).val()).toLowerCase(),$(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"]:checked').val(),$(this).closest(".general-search-container").children(".icon_search_result")))})),$(document).on("click","#editor_nav .icon_search + button",(function(){$(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"]:checked').prop("checked",!1),$(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"][value=""]').prop("checked",!0),d($.trim($(this).parent().children(".icon_search").val().toLowerCase()),$(this).closest(".general-search-container").find('.icon-filter-list input[type="radio"]:checked').val(),$(this).closest(".general-search-container").children(".icon_search_result"))})),$(document).on("click","#editor_nav .icon-filter-list input",(function(){d(a,$(this).val(),$(this).closest(".general-search-container").children(".icon_search_result"))})),$("#share_container .social-channel").on("click",(function(){var e=$(this).attr("data-platform");i.share(page,[e],(function(){}))})),$(".admin-generate-thumbnail").on("click",(function(){var e=$(this),t=Math.max(page.dimension.width,page.dimension.height),i=Math.min(1,Math.max(.25,500/t));e.prop("disabled",!0),VGEditor.exportAs(page,{file:page.identifier,format:"png",scale:i,downloadable:!1},(function(t){t?$.ajax({url:"/infograph/all_thumbnails/"+page.identifier,type:"POST",data:"image_data="+encodeURIComponent(t.toDataURL("image/png")),processData:!1}).done((function(e){})).always((function(){e.prop("disabled",!1)})):e.prop("disabled",!1)}))})),$(window).scroll((function(){$(window).scrollTop()>0?$("#infographic_controls").addClass("active"):$("#infographic_controls").removeClass("active")})),e){var s=function(){var e=window.getSelection?window.getSelection():document.selection?document.selection:null;e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())};$("#multipage_share_panel").on("click",(function(e){s()})),$("#copy_link_btn").on("click","#copy_private_link",(function(e){var t='<img class="icon-sm" src="/media/v2_img/checkmark.svg" alt="Green Checkmark"><;>'+__localizedStrings["editor.share.copy_clipboard"],i=$("#private_share_link_field").get(0);i&&(function(e){var t,i;window.getSelection&&document.createRange?((t=document.createRange()).selectNodeContents(e),(i=window.getSelection()).removeAllRanges(),i.addRange(t)):document.selection&&document.body.createTextRange&&((t=document.body.createTextRange()).moveToElementText(e),t.select());try{return document.execCommand("copy"),s(),JSON.parse(document.getElementById("infographicMetadata").innerHTML)&&mixpanel.track("Copy Private Link Multipage"),!0}catch(e){console.log("Unable to copy",e)}}(i)||(t=__localizedStrings["editor.share.copy_blocked"]),$("#copy_link_btn").find(".notify").html(t).removeAttr("style").addClass("notifySuccess").delay(1e3).fadeOut().click((function(){$(this).stop(!0,!0).html("")})))}))}$(window).resize((function(e){e.target===window&&(r(),VGEditor.widgetCanvas.resizeCanvas())}))})),window.sluggify_string=function(e){return(e=(e=(e=(e=e.replace(/\s+/g,"-")).replace(/[^a-zA-Z0-9_-]/g,"")).replace(/-{2,}/g,"-")).replace(/(^-)|(-$)/g,"")).toLowerCase()},window.generateGrid=l,window.activateEmbedOptions=function(){$("#embed_border_on, #embed_border_off, #embed_responsive, #embed_fixed, #embed_footer_on, #embed_footer_off").click((function(){d(),s()}))},window.generateEmbedCode=d,window.generateNewEmbed=s,window.renderNewEmbedOptions=function(e){var t=!1;-1!==e.indexOf("/pl/")&&(t=!0);var i=$("<div>");i.append($("<label>",{class:"control-label label-heading",text:t?"Private Share Link":"Public Share Link"}));var a=$("<input>",{id:"new_public_link",class:"publish-link",value:e,disabled:!0}),n=$('<div class="link-input-wrapper">'),o=t?"Click on Private Share Link":"Click on Public Share Link";if(i.append(n.append($("<img>",{class:"publish-link-icon",src:"/media/v2_img/share-link.svg",alt:"publish-link"}),a,$("<button>",{id:"copy_public_link_btn",class:"green-square-btn",text:"COPY LINK",onClick:"clickOnLinkBtn(event); mixpanel.track('"+o+"');","data-vg-test-label":"copy-link-button"}))),i.append($("<hr>",{class:"visibleBreak"})),i.append($("<label>",{class:"control-label label-heading",text:t?"Team Share":"Embed & Social Media"})),t){if(!premiumAccess){var r=$("<input>",{type:"checkbox","data-vg-test-label":"comment-checkbox",id:"comments_switch",name:"comments_switch"});!isCommentsEnabled&&isOpenedCommentMode||r.attr("checked",!0),n.append(r,$("<label>",{for:"comments_switch",id:"comments_switch_label",text:"Turn on comments"}))}var l=$("<input>",{type:"checkbox",name:"team_share",id:"team_share_toggle"}),d=$("<label>",{class:"share-status share-disabled",for:"team_share_toggle",text:"Team sharing is currently off"});isTeamShareEnabled&&(l.attr("checked",!0),d.addClass("share-enabled").text("Your team can view this design").prepend($("<img>",{class:"icon-sm",src:"/media/v2_img/checkmark.svg",alt:"Green Checkmark"}))),i.append($("<div>",{id:"team_share_switch",class:"team-share-switch flex-row"}).append($('<label class="switch">').append(l,$("<div>",{id:"slider_switch",class:"slider round"})),d)),$("#new_share_menu").hide()}else i.append($('<div class="link-input-wrapper">').append($("<input>",{id:"new_embed",class:"publish-link",disabled:!0}),$("<button>",{id:"copy_embed_code",class:"green-square-btn",text:"GET CODE",onClick:"clickOnLinkBtn(event); mixpanel.track('Embed Code Click');","data-vg-test-label":"copy-embed-code-button"}))),$("#new_share_menu").show();if($("#new_embed_options").empty(),$("#new_embed_options").append(i),premiumAccess&&t){$("#new_embed_options").prepend($("<div>",{class:"new-embed-options-premium-overlay"}));var s=$("<div>");s.append($("<a>",{href:"".concat(SITE_URL,"account/subscription/business"),text:"Upgrade to Business"})),s.append($("<span>",{text:" to add comments and share designs with your team."})),$("#new_embed_options").append(s)}},window.renderInitialEmbedOptions=function(e){var t=$("<div>");t.append($("<hr>")),t.append($("<label>",{class:"control-label",text:"URL"})),t.append($("<div>").append($("<a>",{class:"publish-link",href:e,target:"_blank",text:e}))),t.append($("<label>"),{class:"control-label",text:window.__localizedStrings["editor.embed_code"]}),t.append($("<div>",{class:"btn-group gray-radio-options"}).append($("<input>",{type:"radio",name:"embed_border",id:"embed_border_off",value:"false",checked:"checked"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_border_off",text:window.__localizedStrings["editor.no_border"]})).append($("<input>",{type:"radio",name:"embed_border",id:"embed_border_on",value:"true"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_border_on",text:window.__localizedStrings["editor.border"]}))),t.append($("<hr>")),t.append($("<div>",{class:"btn-group gray-radio-options"}).append($("<input>",{type:"radio",name:"embed_footer",id:"embed_footer_off",value:"false"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_footer_off",text:window.__localizedStrings["editor.no_footer"]})).append($("<input>",{type:"radio",name:"embed_footer",id:"embed_footer_on",value:"true",checked:"checked"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_footer_on",text:window.__localizedStrings["editor.footer"]}))),t.append($("<hr>")),t.append($("<div>",{class:"btn-group gray-radio-options"}).append($("<input>",{type:"radio",name:"embed_layout",id:"embed_responsive",value:"responsive",checked:"checked"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_responsive",text:window.__localizedStrings["editor.responsive"]})).append($("<input>",{type:"radio",name:"embed_layout",id:"embed_fixed",value:"fixed"})).append($("<label>",{class:"btn btn-gray-hollow gray-radio-option",for:"embed_fixed",text:window.__localizedStrings["editor.fixed"]}))),t.append($("<hr>")),t.append($("<div>").append($("<textarea>",{id:"textarea_embed",onClick:"mixpanel.track('Embed Code Click');"}))),$("#embed_options").empty(),$("#embed_options").append(t)};i(1622),i(1623);var c=i(51),p=i.n(c);function u(e){var t=1==e?1:0;$.ajax({type:"PUT",url:"/rest/infograph/set_public/"+pageId,data:JSON.stringify({is_public:t}),success:function(t,i,a){is_public=e,200!=t.code&&create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null)}})}function g(e,t,i){$.ajax({type:"PUT",url:"/rest/multipage/save_title",data:JSON.stringify({infographic:e,title:t}),success:function(){mixpanel.track("Change Infographic Title",{new_title:t,prev_title:i}),$("#infographic_title").removeAttr("style"),$("#input_infographic_title").val(t),$("#infographic_title").html(t)}})}$(document).ready((function(){var e=USER_MEDIA_LIBRARY,t=null,i=!!userHasNoTeam,a=function(a){t||setTimeout((function(){t=new Viz.ImageUpload({containerId:"user-media-result",dropzoneSelector:"",userMediaBucket:userMediaBucket,enableMediaCounter:i,mediaMaxLimit:mediaMaxLimit},e,n),$("#drag_drop_upload_box").click((function(){var e=t.getMediaCount();c(e)?event.preventDefault():($("#upload_filename").click(),mixpanel.track("Click drag and drop box"))})),$("#user_media_upload_button").click((function(){var e=t.getMediaCount();c(e)?event.preventDefault():($("#upload_filename").click(),mixpanel.track("Upload from CTA"))})),$("#upload_filename").on("change",(function(e){var i=e.target.files[0];t.uploadImage(e,i,!1),mixpanel.track("Image Uploaded"),$("#upload_filename")[0].value=""})),t.renderMediaCounter()}),10),"replace-uploads"===a&&setTimeout((function(){$.ajax({type:"GET",url:"/usermedialibrary/list",dataType:"json"}).done((function(i,a,n){e=i,t.data=e})).fail((function(e,t,i){console.log("error: ",i)})),$("#replace_menu_upload_box").click((function(){var e=t.getMediaCount();c(e)?event.preventDefault():$("#upload_filename").click()})),$("#replace_menu_upload_button").click((function(){var e=t.getMediaCount();c(e)?(event.preventDefault(),mixpanel.track("Click on Upgrade",{"Button Number":"replace menu media library button"})):($("#upload_filename").click(),mixpanel.track("Upload from CTA",{category:"replace menu"}))})),t.renderMediaCounter()}),10)};function n(){reInitSideBar()}function o(e){if(e.originalEvent&&e.originalEvent.dataTransfer){var t=e.originalEvent.dataTransfer.types;return Array.isArray(t)?-1!==t.indexOf("Files"):"object"===p()(t)&&t.contains("Files")}}window.updateImageUpload=a,$(".editor-top-level-menu").on("click.editor_menu",(function(){a("user-media-result")}));var r=$("#drag_drop_upload_box,#infographic"),l=$("#drag_drop_upload_box"),d=$("#editor_menu_uploads"),s=0;r.on("dragenter",(function(e){o(e)&&(0!==s||d.parent().hasClass("open")||d.click(),s+=1,l.addClass("drag-drop-upload-hover"))})),r.on("dragleave drop",(function(e){o(e)&&0===(s-=1)&&l.removeClass("drag-drop-upload-hover")})),$("#drag_upload_filename").fileupload({url:"/usermedialibrary/upload",dataType:"json",dropZone:r,drop:function(e,t){t.files.length>multipleUploadLimit&&create_simple_modal(null,"error_modal",__localizedStrings["editor.images.error"],__localizedStrings["editor.images.drag_error_1"]+multipleUploadLimit+__localizedStrings["editor.images.drag_error_2"],null,null,null)},add:function(e,i){if(i.originalFiles.length>multipleUploadLimit)return!1;var a=i.files[0];return!!t.validateFile(a)&&(!c()&&(t.uploadImage(e,a,!0),void i.submit()))},submit:function(e,t){t.formData={file_count:t.originalFiles.length}},success:function(e,i){$("#user_media_library_list .loadingContainer").hide(),mixpanel.track("Drag and drop upload");var a="https://s3.amazonaws.com/"+userMediaBucket+e.file_id;t.renderUploadedImage(a,e.original_name,!0);var n=$("#user_media_library_list #"+e.original_name.replace(/[^a-zA-Z0-9]/g,""));n.attr("data-widget-url",a);var o=new Image;o.onload=function(){n.find(".upload-loading-overlay").fadeOut(300),t.activateDeleteUserMediaButton(),n.removeAttr("id"),reInitSideBar({}),1===parseInt(e.original_data.file_count)&&n.click()},o.src=a},error:function(e,t){$("#user_media_library_list .loadingContainer").hide()}});var c=function(){var e=t.getMediaCount();if(e>mediaMaxLimit-1){var i="";return userHasNoTeam&&(i='\n                    <a class="btn btn-yellow btn-sm" href="/account/subscription'.concat(allowPremiumWidgets?"/business":"","\"\n                        onclick=\"mixpanel.track('Click On Upgrade', {'Button Number': 'media library button'});\n                            Intercom('trackEvent', 'Click On Upgrade', {'Button Number': 'media library button'});\"\n                    >\n                        ").concat(__localizedStrings.upgrade,"\n                    </a>")),create_simple_modal(null,"error_modal",__localizedStrings["editor.images.max"],__localizedStrings["editor.upload_1"]+e+__localizedStrings["editor.upload_2"],i,null,null),!0}return!1}})),window.setPublic=u,window.publishToCommunity=function(e){var t=Math.max(page.dimension.width,page.dimension.height),i=Math.min(1,Math.max(.25,500/t));VGEditor.exportAs(page,{file:page.identifier,format:"png",scale:i,downloadable:!1},(function(e){e?$.ajax({url:"/infographics/community_image/"+page.identifier,type:"POST",data:"image_data="+encodeURIComponent(e.toDataURL("image/png")),processData:!1}).done((function(e){console.log("Community Thumbnail",e)})).fail((function(e){console.log("failed generating community thumbnail",e)})):console.log("failed, no canvas")}));var a=$("#publish_modal #publish_infographic_title").val();page.report_title=a,page.save(),a!==pageTitle&&(mixpanel.track("Change Infographic Title",{prev_title:pageTitle,new_title:a}),pageTitle=a),$("#input_infographic_title").val(pageTitle),$("#infographic_title").html(pageTitle),$.ajax({type:"POST",url:"/community/create",data:"id="+pageId+"&title="+pageTitle,dataType:"json",success:function(t,i,a){"ok"==t.status?(u(!0),mixpanel.track("Click On Publish"),$(".modal, .modal-backdrop").remove(),$("body").removeClass("modal-open").css("overflow",""),$("#publish_to_community").data("published",!0).html(__localizedStrings["editor.publish.unpublish"]),$.ajax({url:"/community/get_by_id/"+pageId,dataType:"jsonp",contextType:"application/jsonp",success:function(t){var i=window.location.href.match("https?://[^/]*")+"/p/"+t.community_id+"/"+sluggify_string(t.title);renderInitialEmbedOptions(i),activateEmbedOptions(),embedData.community_id=t.community_id,generateEmbedCode(),$("#btn_preview").attr("href",i),"function"===typeof e&&e()},error:function(e){console.log(e)}})):create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null)}})},window.publishMultipage=function(e){var t=JSON.parse(document.getElementById("infographicMetadata").innerHTML),i=$("#publish_modal #publish_infographic_title").val();"undefined"!==typeof i&&i!==pageTitle&&(g(t.id,i,pageTitle),pageTitle=i),$.ajax({url:"/multipage/infographic/publish",type:"post",contentType:"application/json",data:JSON.stringify({infographic:t.id,templateId:t.template_id,title:pageTitle}),success:function(i){"ok"==i.status?(detectPhishing("Publish",i.slug),is_public=!0,$("#publish_to_community").data("published",!0).html(__localizedStrings["editor.publish.unpublish"]),$(".modal, .modal-backdrop").remove(),$("body").removeClass("modal-open").css("overflow",""),renderInitialEmbedOptions("".concat(newDomain,"/").concat(i.slug)),renderNewEmbedOptions("".concat(SITE_URL).concat(i.slug)),activateEmbedOptions(),generateEmbedCode(),generateNewEmbed(),mixpanel.track("Click On Publish",{templateId:t.template_id}),"function"==typeof e&&e()):create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null)}})},window.unpublishMultipage=function(e,t){var i=JSON.parse(document.getElementById("infographicMetadata").innerHTML);"undefined"===typeof t&&(t=!1),$.ajax({url:"/multipage/infographic/unpublish",type:"post",contentType:"application/json",data:JSON.stringify({infographic:i.id}),success:function(a){if("ok"==a.status){if(is_public=!1,$("#publish_to_community").data("published",!1).html(__localizedStrings["editor.publish"]),$("#btn_preview").attr("href","".concat(SITE_URL,"view/").concat(i.id)),$("#embed_options").empty(),e){if(t)var n="Changing to \u2018Private\u2019 will remove share links";else n="Changing to \u2018Hidden\u2019 will remove share links";create_simple_modal("unpublish-info-modal","unpublished_modal",n,"People who you have shared links with will no longer be able to access this design on the web.",'<button type="button" class="btn btn-gray btn-sm close-modal confirm-unpublish-btn" data-vg-test-label="modal-confirm-button">GOT IT</button>',null,null)}else create_simple_modal("modal-sm","unpublished_modal",__localizedStrings["editor.publish.infographic_unpublished"],__localizedStrings["editor.publish.community_remove"],null,null,null);mixpanel.track("Click On Unpublish")}else create_simple_modal(null,"error_modal",__localizedStrings["editor.error"],__localizedStrings["editor.error_occurred"],null,null,null)}})},window.updateMultipageTitle=g,window.copyToClipboard=function(e){var t;e.attr("disabled",!1),e.select(),e.attr("disabled",!0);try{t=document.execCommand("copy")}catch(e){t=!1,console.error(e)}return t},window.clickOnLinkBtn=function(e){var t=$(e.target).prev(),i=copyToClipboard(t),a=$(e.target).text();$(e.target).text(i?"COPIED!":"FAILED!").css({background:i?"#02A81F":"#d3454c"}),$(e.target).attr("disabled",!0),setTimeout((function(){t.attr("disabled",!1),$("#publish_in_share").focus(),t.attr("disabled",!0),$(e.target).text(a).css({background:"#1bc138"}),$(e.target).attr("disabled",!1)}),500)},window.toggleSelectedOption=function(e,t){t?(e.removeClass("selectedOption"),e.find(".share-option-icon").removeClass("selectedOption")):(e.addClass("selectedOption"),e.find(".share-option-icon").addClass("selectedOption"))},window.handleUnpublishOption=function(e){if(!e){$("#new_embed_options").prepend($("<div>",{class:"new-embed-options-overlay"})),$(".link-input-wrapper .green-square-btn").css({background:"#eeeeee"}),$(".link-input-wrapper #new_public_link").val("https://infograph.venngage.com/ps/..."),$(".link-input-wrapper #new_embed").val('<script src="https://infograph.venngage.com/js/embed...')}}}});